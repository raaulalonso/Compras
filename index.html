<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de la Compra</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            text-align: center;
        }
        #lista {
            list-style-type: none;
            padding: 0;
        }
        #lista li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #ddd;
        }
        #lista li button {
            background-color: #ff4444;
            color: white;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
        }
        #agregarForm {
            display: flex;
            margin-top: 20px;
        }
        #itemInput {
            flex-grow: 1;
            padding: 5px;
        }
        #agregarBtn, #reiniciarBtn {
            padding: 5px 10px;
            cursor: pointer;
        }
        #reiniciarBtn {
            display: block;
            margin: 20px auto;
            background-color: #ffaa00;
            color: white;
            border: none;
        }
    </style>
</head>
<body>
    <h1>Lista de Compras</h1>
    <ul id="lista"></ul>
    <form id="agregarForm">
        <input type="text" id="itemInput" placeholder="Agregar item" required>
        <button type="submit" id="agregarBtn">Agregar</button>
    </form>
    <button id="reiniciarBtn">Reiniciar Lista</button>

	<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
	<script type="module">
		// ...

		// TODO: Replace the following with your app's Firebase project configuration
		const firebaseConfig = {
			apiKey: "AIzaSyCpC3wNuyv2iAM-3EfdHNKUsdupzzhGu-Q",
			authDomain: "listacompra-874d8.firebaseapp.com",
			projectId: "listacompra-874d8",
			storageBucket: "listacompra-874d8.appspot.com",
			messagingSenderId: "141147095610",
			appId: "1:141147095610:web:2733150de00e1fc8caab03",
			measurementId: "G-GVWZMBF02G"
		};

		// Initialize Firebase
		const app = initializeApp(firebaseConfig);
		const analytics = getAnalytics(app);
		// Inicializar Firebase (reemplace con su configuraci贸n)

		// Referencias a elementos del DOM
		const itemInput = document.getElementById('itemInput');
		const addButton = document.getElementById('addButton');
		const itemList = document.getElementById('itemList');
		const loginButton = document.getElementById('loginButton');
		const logoutButton = document.getElementById('logoutButton');

		// Autenticaci贸n
		loginButton.addEventListener('click', () => {
			const provider = new firebase.auth.GoogleAuthProvider();
			firebase.auth().signInWithPopup(provider);
		});

		logoutButton.addEventListener('click', () => {
			firebase.auth().signOut();
		});

		firebase.auth().onAuthStateChanged((user) => {
			if (user) {
				// Usuario ha iniciado sesi贸n
				loginButton.style.display = 'none';
				logoutButton.style.display = 'block';
				loadItems();
			} else {
				// Usuario ha cerrado sesi贸n
				loginButton.style.display = 'block';
				logoutButton.style.display = 'none';
				itemList.innerHTML = '';
			}
		});

		// Agregar item
		addButton.addEventListener('click', () => {
			const item = itemInput.value.trim();
			if (item && firebase.auth().currentUser) {
				const userId = firebase.auth().currentUser.uid;
				firebase.database().ref('shoppingLists/' + userId).push({
					name: item,
					createdAt: firebase.database.ServerValue.TIMESTAMP
				});
				itemInput.value = '';
			}
		});

		// Cargar items
		function loadItems() {
			const userId = firebase.auth().currentUser.uid;
			firebase.database().ref('shoppingLists/' + userId).on('value', (snapshot) => {
				itemList.innerHTML = '';
				snapshot.forEach((childSnapshot) => {
					const item = childSnapshot.val();
					const li = document.createElement('li');
					li.textContent = item.name;
					const deleteButton = document.createElement('button');
					deleteButton.textContent = 'Eliminar';
					deleteButton.onclick = () => {
						childSnapshot.ref.remove();
					};
					li.appendChild(deleteButton);
					itemList.appendChild(li);
				});
			});
		}
  	</script>
</body>
</html>